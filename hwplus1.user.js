// ==UserScript==
// @name         Hitwicket+
// @namespace    Hitwicket+
// @version      1.2
// @description  Adds additional functionalities to Hitwicket and optimizes existing
// @include      http://hitwicket.com/*
// @exclude      http://hitwicket.com/session/*
// @require      https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.6.0/moment.min.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js
// @copyright    akshay9
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_listValues
// ==/UserScript==
if($("#login-form").length==0){var prefix="hw_1.0_";var currURL=location.href;var arrURL=currURL.split("/");function xp_level(e){switch(e){case 0:level="Non-existant";break;case 1:level="Horrible";break;case 2:level="Hopeless";break;case 3:level="Useless";break;case 4:level="Mediocre";break;case 5:level="Average";break;case 6:level="Reliable";break;case 7:level="Accomplished";break;case 8:level="Remarkable";break;case 9:level="Brilliant";break;case 10:level="Exemplary";break;case 11:level="Prodigious";break;case 12:level="Fantastic";break;case 13:level="Magnificent";break;case 14:level="Masterful";break;case 15:level="Supreme";break;case 16:level="Magical";break;case 17:level="Legendary";break;case 18:level="Wonderous";break;case 19:level="Demigod";break;case 20:level="Titan";break}return level}function skill_level(e){switch(e){case 1:level="Hopeless";break;case 2:level="Poor";break;case 3:level="Unreliable";break;case 4:level="Decent";break;case 5:level="Good";break;case 6:level="Superb";break}return level}function getAtri(e,t){var n={};$.get("http://s2.hwstats.tk/auctionapi/"+e,function(e,r){if(r=="success"){n=e;if(n.status=="success"){n.xpName=xp_level(n.xp);n.formName=skill_level(n.form);n.fitnessName=skill_level(n.fitness)}}t(n)})}function createPAtri(e,t){var n=xp_level(t);var r='<div class="skill_bars"><span class="skill_name">'+e+'</span><div class="progress progress-striped skill_bar"><div class="progress-bar" style="width: '+t*5+'%;"></div></div><span class="skill_level show_popover skill_'+t+'" data="'+t+'" data-original-title="" title="">'+n+'</span><br clear="all"></div>';return r}if(arrURL[3]=="player"&&arrURL[4]=="show"){getAtri(arrURL[5],function(e){if(e.status=="error"){var t='<div style="border-top: 4px solid #444;border-right: 4px solid #444;border-left: 4px solid #444;" class="all_player adjust2"><div style="background: rgba(204, 201, 201, 0.10);" class="player_info"><strong>No data available for this player.</strong></div></div>'}else{if(e.sell_status==0){var n="At last auction he was left <strong>UNSOLD</strong> at <strong>Rs "+e.price+"</strong> on <strong>"+e.time+"</strong><br>"}else{var n="At last auction he was <strong>SOLD</strong> at <strong>Rs "+e.price+"</strong> on <strong>"+e.time+"</strong><br>"}var r='<div style="border-top: 4px solid #444;border-right: 4px solid #444;border-left: 4px solid #444;" class="all_player adjust2"><div style="background: rgba(204, 201, 201, 0.10);" class="player_info"> <p>'+n+" He was a <strong>"+Math.round(e.age/70-.5)+" yrs "+e.age%70+' days</strong> old.<br> His experience level was <span class=" show_popover skill_'+e.xp+'" data="'+e.xp+'" data-original-title="" title=""> '+e.xpName+'</span> and was in <span class="show_secondary_popover secondary_skill_'+e.form+'" data="'+e.form+'" data-original-title="" title=""> '+e.formName+'</span> form & <span class="show_secondary_popover secondary_skill_'+e.fitness+'" data="'+e.fitness+'" data-original-title="" title=""> '+e.fitnessName+'</span> fitness. <br><span class="show_tooltip cursor_help" title="" data-original-title="This was a metric used to measure the overall skill set of your players that gives a general idea of the player\'s worth"> His Skill Index was </span><strong>'+e.si+"</strong> and was paid a Salary of Rs <strong>"+e.salary+'</strong> every week.<br></p></div><section style="background: rgba(204, 201, 201, 0.36);" class="large_skill_bars">';var i="</section></div>";var t=r+createPAtri("Fielding",e.fielding)+createPAtri("Wicket-keeping",e.wicket)+createPAtri("Batting vs seam bowlers",e.bat_seam)+createPAtri("Batting vs spin bowlers",e.bat_spin)+createPAtri("Bolwing main",e.bowl_main)+createPAtri("Bolwing variation",e.bowl_var)+i}$(".all_player").after(t)});var ageRaw=$("div.player_info p strong").first().text();var ageArray=ageRaw.replace(" yrs","").replace(" days","").split(" ");var age=ageArray[0]*70+ageArray[1]*1;$(".moments_of_glory").click(function(){$.get("/player/momentsOfGlory",{id:arrURL[5]},function(e){$("#moments_of_glory").html(e);var t=0;$("#moments_of_glory").find("tr").each(function(){if(t!=0){var e=$(this).find("td").last().text();var n=age-(moment().unix()-moment(e,"DD-MM-YYYY").unix())/(60*60*24);var r=Math.round(n/70-.5);var s=Math.round(n%70);var o=e+"<br>("+r+" yrs "+s+" days)";$(this).find("td").last().html(o)}t++})})});$(".level_logs").click(function(){$.get("/player/levelLogs",{id:arrURL[5]},function(e){$("#level_logs").html(e);var t=0;$("#level_logs").find("tr").each(function(){if(t!=0){var e=$(this).find("td").last().text();var n=age-(moment().unix()-moment(e,"DD-MM-YYYY").unix())/(60*60*24);var r=Math.round(n/70-.5);var s=Math.round(n%70);var o=e+"<br>("+r+" yrs "+s+" days)";$(this).find("td").last().html(o)}t++})})})}}
